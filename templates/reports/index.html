{% extends 'reports/base.html' %}

{% load bootstrap3 %}

{% block title %}reports index{% endblock %}

{% block content %}

<h1>reports</h1>

<p>You are logged in as {{ user }}.</p>

<section>

  <h2>View report</h2>

  <form action="{% url 'reports:view_report' %}" method="get" class="form">
    {% comment %}
    <!-- This gets in the way of saving queries by GET URI. -->
    <!-- csrf vulnerability: Cross-site DoS by spamming queries. -->
    <!-- Probably not a serious concern. -->
    {% csrf_token %}
    {% endcomment %}
    {% bootstrap_form form %}
    <div id="fields">
    </div>
    {% buttons submit='Generate' reset='Reset' %}
    {% endbuttons %}
  </form>

  <script src="{% url 'reports:dynamic_fields.js' %}">
  </script>

</section>

<section>

  <h2>Update</h2>

  <p>{{ connected }}</p>

  <form action="{% url 'reports:oauth' %}" method="get" class="form">
    {% csrf_token %}
    {% buttons submit='Connect to drchrono' %}
    {% endbuttons %}
  </form>

  <p>{{ last_updated }}</p>

  <form action="{% url 'reports:update' %}" method="post" class="form">
    {% csrf_token %}
    {% buttons submit='Import data from drchrono' %}
    {% endbuttons %}
  </form>

</section>

{% endblock %}
